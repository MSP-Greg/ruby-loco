diff --git a/win32/setup.mak b/win32/setup.mak
index 0a1421f0bb..8275d14890 100644
--- a/win32/setup.mak
+++ b/win32/setup.mak
@@ -222,7 +222,10 @@ echo TEENY = RUBY_VERSION_TEENY
 echo ABI_VERSION = RUBY_ABI_VERSION
 #endif
 set /a MSC_VER = _MSC_VER
-#if _MSC_VER >= 1920
+#if _MSC_VER >= 1940
+set /a MSC_VER_LOWER = (MSC_VER-20)/20*20+0
+set /a MSC_VER_UPPER = MSC_VER/20*20+19
+#elif _MSC_VER >= 1920
 set /a MSC_VER_LOWER = MSC_VER/20*20+0
 set /a MSC_VER_UPPER = MSC_VER/20*20+19
 #elif _MSC_VER >= 1900
