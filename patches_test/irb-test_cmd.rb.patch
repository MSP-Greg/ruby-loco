diff --git a/prelude.rb b/prelude.rb
index ee78b44cc5..f9e93880fa 100644
--- a/prelude.rb
+++ b/prelude.rb
@@ -1,3 +1,12 @@
+begin
+  require 'rbconfig' unless defined?(RbConfig)
+  ENV['SSL_CERT_FILE']  = "#{RbConfig::TOPDIR}/bin/etc/ssl/cert.pem"
+  ENV['SSL_CERT_DIR']   = "#{RbConfig::TOPDIR}/bin/etc/ssl/certs"
+  ENV['OPENSSL_CONF']   = "#{RbConfig::TOPDIR}/bin/etc/ssl/openssl.cnf"
+  ENV['OPENSSL_MODULES'] = "#{RbConfig::TOPDIR}/bin/lib/ossl-modules"
+rescue LoadError => e
+end
+
 class Binding
   # :nodoc:
   def irb
diff --git a/test/irb/test_cmd.rb b/test/irb/test_cmd.rb
index 7d7353281e..8bdb14b844 100644
--- a/test/irb/test_cmd.rb
+++ b/test/irb/test_cmd.rb
@@ -826,6 +826,10 @@ def test_show_doc_without_rdoc
   end
 
   class EditTest < CommandTestCase
+
+    # used for running tests from install folder
+    LIB_PATH = RbConfig::CONFIG['rubylibdir']
+
     def setup
       @original_visual = ENV["VISUAL"]
       @original_editor = ENV["EDITOR"]
@@ -875,7 +879,7 @@ def test_edit_with_constant
       )
 
       assert_empty err
-      assert_match(/path: .*\/lib\/irb\.rb/, out)
+      assert_include out, "path: #{LIB_PATH}/irb.rb"
       assert_match("command: ': code'", out)
     end
 
@@ -885,7 +889,7 @@ def test_edit_with_class_method
       )
 
       assert_empty err
-      assert_match(/path: .*\/lib\/irb\.rb/, out)
+      assert_include out, "path: #{LIB_PATH}/irb.rb"
       assert_match("command: ': code'", out)
     end
 
@@ -895,7 +899,7 @@ def test_edit_with_instance_method
       )
 
       assert_empty err
-      assert_match(/path: .*\/lib\/irb\.rb/, out)
+      assert_include out, "path: #{LIB_PATH}/irb.rb"
       assert_match("command: ': code'", out)
     end
 
